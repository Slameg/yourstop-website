<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>YourStop — Minecraft сервер</title>
  <meta name="description" content="YourStop — дружелюбный Minecraft-сервер. Подключиться: yourstop.online"/>

  <!--
    Single-file portal:
    - Настройки: внизу JS-конфига (переменные SERVER, DISCORD_INVITE, DONATE_LINK, WALLET_ADDRESS)
    - Статус сервера берётся из публичного API api.mcsrvstat.us (в браузере).
    - Если нужен 100% беззависимый статус — потребуется серверный прокси/pinger (могу помочь отдельно).
  -->

  <style>
    :root{
      --bg-1:#050816; --bg-2:#07142b;
      --card: rgba(11,18,32,0.86);
      --accent:#60a5fa; --accent2:#2dd4bf;
      --muted:#9fb2c9; --glass: rgba(255,255,255,0.03);
      --glass-2: rgba(255,255,255,0.04);
      --text: #e6eef8;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:var(--text);background:linear-gradient(180deg,var(--bg-1),var(--bg-2));-webkit-font-smoothing:antialiased}
    canvas.bg{position:fixed;inset:0;z-index:-2}
    .nebula{position:fixed;inset:0;background:radial-gradient(circle at 10% 30%, rgba(96,165,250,0.08), transparent 8%), radial-gradient(circle at 90% 70%, rgba(45,212,191,0.06), transparent 10%);z-index:-1;filter:blur(18px);pointer-events:none}
    .wrap{max-width:1100px;margin:28px auto;padding:20px}
    header.top{display:flex;align-items:center;gap:16px}
    .logo{width:72px;height:72px;border-radius:16px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;color:#02101f;font-weight:900;font-size:26px;box-shadow:0 6px 28px rgba(96,165,250,0.22)}
    h1{margin:0;font-size:24px}
    .lead{margin:6px 0;color:var(--muted)}
    nav.tabs{display:flex;gap:8px;margin-top:18px;flex-wrap:wrap}
    .tab{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.03);cursor:pointer;color:var(--text);font-weight:700;transition:all .18s}
    .tab.active{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#022033;box-shadow:0 8px 24px rgba(96,165,250,0.12)}
    .content{display:grid;grid-template-columns:1fr 340px;gap:20px;margin-top:18px}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 12px 40px rgba(2,6,23,0.6);backdrop-filter: blur(6px)}
    /* Status area */
    .status-head{display:flex;gap:12px;align-items:center}
    .status-badge{width:92px;height:92px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:16px}
    .online{background:linear-gradient(90deg,#34d399,var(--accent));color:#052023}
    .offline{background:#374151;color:#fff}
    .motd{font-size:18px;margin-bottom:6px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    .btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:800;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#022033}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(96,165,250,0.12)}
    .meta{display:flex;gap:14px;margin-top:12px;flex-wrap:wrap}
    .meta .block{min-width:120px}
    .players-list{margin-top:10px;display:flex;flex-direction:column;gap:8px}
    .player{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;background:var(--glass-2);font-size:14px}
    /* Right column */
    .side .links{padding-left:14px}
    .ip-big{font-weight:900;font-size:20px;margin-top:8px}
    .donate-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    .donate-card{padding:12px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));text-align:center}
    .rules{line-height:1.5;color:var(--muted);padding-top:6px}
    footer{margin-top:20px;text-align:center;color:var(--muted);font-size:13px}
    /* Tabs content containers */
    .pane{display:none}
    .pane.active{display:block}
    /* animations */
    .fade-in{animation:fadeIn .5s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
    /* small screens */
    @media(max-width:920px){.content{grid-template-columns:1fr;}.logo{width:56px;height:56px;border-radius:12px}}
  </style>
</head>
<body>
  <canvas class="bg"></canvas>
  <div class="nebula"></div>

  <div class="wrap">
    <header class="top">
      <div class="logo">YS</div>
      <div>
        <h1>YourStop</h1>
        <div class="lead">Лучший сервер выживания — подключайся: <strong id="ip-display">yourstop.online</strong></div>
      </div>
    </header>

    <nav class="tabs" aria-label="Главное меню">
      <button class="tab active" data-target="home">Статус</button>
      <button class="tab" data-target="rules">Правила</button>
      <button class="tab" data-target="donate">Донат</button>
      <button class="tab" data-target="discord">Discord</button>
      <button class="tab" data-target="about">О сервере</button>
    </nav>

    <div class="content">
      <!-- MAIN COLUMN -->
      <main>
        <section id="home" class="pane active card fade-in">
          <div class="status-head">
            <div id="status-badge" class="status-badge">—</div>
            <div>
              <div id="motd" class="motd">Загрузка статуса...</div>
              <div id="ver" style="color:var(--muted)">Версия: —</div>
            </div>
          </div>

          <div class="controls">
            <button id="copy-ip" class="btn">Скопировать IP</button>
            <button id="join" class="btn ghost">Как подключиться</button>
            <button id="refresh" class="btn ghost" title="Принудительно обновить">Обновить</button>
          </div>

          <div class="meta">
            <div class="block">
              <div style="color:var(--muted);font-weight:700">Игроки</div>
              <div id="players" style="margin-top:8px;color:var(--text)">Загрузка...</div>
              <div id="players-list" class="players-list" style="display:none"></div>
            </div>

            <div class="block">
              <div style="color:var(--muted);font-weight:700">Ping</div>
              <div id="ping" style="margin-top:8px;color:var(--text)">— ms</div>
              <div id="uptime" style="margin-top:8px;color:var(--muted);font-size:13px"></div>
            </div>
          </div>
        </section>

        <section id="rules" class="pane card">
          <h3>Правила сервера</h3>
          <div class="rules">
            <ol>
              <li>Запрещён griefing — не ломай и не кради чужие постройки.</li>
              <li>Без оскорблений и дискриминации — уважай игроков и персонал.</li>
              <li>Запрещена реклама без разрешения админов.</li>
              <li>Следуйте решениям модераторов — их указания обязательны.</li>
              <li>Использование читов/модов дающих явное преимущество — бан.</li>
            </ol>
            <p style="margin-top:10px;color:var(--muted)">Полные правила находятся на официальном сайте или в Discord.</p>
          </div>
        </section>

        <section id="donate" class="pane card">
          <h3>Поддержать сервер</h3>
          <p style="color:var(--muted)">Поддержка помогает держать сервер онлайн и развивать проект.</p>

          <div class="donate-grid">
            <div class="donate-card">
              <div style="font-weight:800">Карта / Qiwi</div>
              <div style="margin-top:8px" id="wallet-addr">Номер: <span id="wallet-val">+7 000 000 00 00</span></div>
              <div style="margin-top:10px">
                <button class="btn" id="copy-wallet">Копировать</button>
              </div>
            </div>

            <div class="donate-card">
              <div style="font-weight:800">Онлайн-оплата</div>
              <a id="donate-link" class="btn" href="#" target="_blank" style="display:inline-block;margin-top:12px">Перейти на страницу доната</a>
            </div>
          </div>

          <div style="margin-top:12px;color:var(--muted)">После оплаты — напиши в Discord для подтверждения и выдачи привилегий.</div>
        </section>

        <section id="discord" class="pane card">
          <h3>Discord</h3>
          <p style="color:var(--muted)">Присоединяйся к нашему сообществу для новостей, помощи и соревнований.</p>
          <div style="margin-top:12px">
            <!-- Встроенный виджет можно заменить на iframe от discord (требует SERVER ID). Здесь — кнопка и приглашение -->
            <a id="discord-invite" class="btn" target="_blank" href="#">Открыть Discord</a>
          </div>

          <div style="margin-top:14px;color:var(--muted)">Если у тебя есть ID сервера Discord, замените ссылку приглашения в конфиге для автоподключения.</div>
        </section>

        <section id="about" class="pane card">
          <h3>О сервере</h3>
          <p style="color:var(--muted)">YourStop — дружелюбный survival сервер. Мы поддерживаем лицензионных и пиратов, честную игру и активное комьюнити.</p>
          <ul style="margin-top:8px;color:var(--muted)">
            <li>Стабильный хостинг и регулярные обновления</li>
            <li>Частые эвенты и мини-ивенты</li>
            <li>Система рангов и магазин (донат)</li>
          </ul>
        </section>
      </main>

      <!-- SIDE COLUMN -->
      <aside class="side card">
        <h4>Подключиться</h4>
        <div style="color:var(--muted)">IP сервера:</div>
        <div class="ip-big" id="ip-big">yourstop.online</div>
        <div style="margin-top:10px">
          <button class="btn" id="btn-copy-ip-side">Копировать IP</button>
        </div>

        <div style="margin-top:18px">
          <h4>Полезные ссылки</h4>
          <ul class="links" style="margin-top:8px">
            <li><a href="https://yourstop.ru" target="_blank">Официальный сайт</a></li>
            <li><a id="discord-link" href="#" target="_blank">Discord</a></li>
          </ul>
        </div>

        <div style="margin-top:14px">
          <h4>Статистика сервера</h4>
          <div style="color:var(--muted);margin-top:6px">Автообновление каждые <span id="interval-sec">25</span>s</div>
        </div>
      </aside>
    </div>

    <footer>© 2025 YourStop — все права сохранены</footer>
  </div>

  <script>
    /* ===================== CONFIG =====================
       Отредактируй значения ниже при необходимости:
         - SERVER: IP/домен Minecraft сервера
         - DISCORD_INVITE: ссылка приглашения Discord (https://discord.gg/xxx)
         - DONATE_LINK: ссылка на страницу оплаты/доната
         - WALLET_ADDRESS: номер/адрес для копирования
    =================================================== */
    const SERVER = 'yourstop.online';
    const DISCORD_INVITE = 'https://discord.gg/your-invite'; // замените
    const DONATE_LINK = 'https://yourstop.ru/donate'; // замените
    const WALLET_ADDRESS = '+7 000 000 00 00'; // замените
    const CHECK_INTERVAL = 25; // в секундах
    /* =================== END CONFIG =================== */

    // DOM refs
    const ipDisplay = document.getElementById('ip-display');
    const ipBig = document.getElementById('ip-big');
    const copyIpBtns = [document.getElementById('copy-ip'), document.getElementById('btn-copy-ip-side')];
    const statusBadge = document.getElementById('status-badge');
    const motdEl = document.getElementById('motd');
    const verEl = document.getElementById('ver');
    const playersEl = document.getElementById('players');
    const playersListEl = document.getElementById('players-list');
    const pingEl = document.getElementById('ping');
    const refreshBtn = document.getElementById('refresh');
    const intervalSecEl = document.getElementById('interval-sec');
    const discordInviteEl = document.getElementById('discord-invite');
    const discordLinkEl = document.getElementById('discord-link');
    const donateLinkEl = document.getElementById('donate-link');
    const walletValEl = document.getElementById('wallet-val');
    const copyWalletBtn = document.getElementById('copy-wallet');

    ipDisplay.textContent = ipBig.textContent = SERVER;
    intervalSecEl.textContent = CHECK_INTERVAL;
    discordInviteEl.href = DISCORD_INVITE;
    discordLinkEl.href = DISCORD_INVITE;
    donateLinkEl.href = DONATE_LINK;
    walletValEl.textContent = WALLET_ADDRESS;

    // copy handlers
    function copyText(t){
      navigator.clipboard?.writeText(t).then(()=>{
        showToast('Скопировано: ' + t);
      }).catch(()=>{
        prompt('Скопируйте вручную:', t);
      });
    }
    copyIpBtns.forEach(b=>b.addEventListener('click', ()=>copyText(SERVER)));
    document.getElementById('copy-ip').addEventListener('dblclick', ()=>{ // dblclick => copy and show players?
      copyText(SERVER);
    });
    copyWalletBtn.addEventListener('click', ()=>copyText(WALLET_ADDRESS));
    document.getElementById('join').addEventListener('click', ()=>alert('Открой Minecraft → Multiplayer → Add Server → введи "'+SERVER+'" и нажми Join.'));

    refreshBtn.addEventListener('click', ()=>{ fetchStatus(true); showToast('Обновление...'); });

    const SIMPLE_API = `https://api.mcsrvstat.us/simple/${SERVER}`; // проверка 200/404
    const JSON_API = `https://api.mcsrvstat.us/3/${SERVER}`; // подробная информация

    let lastStatus = null;
    async function fetchStatus(force=false){
      try{
        const r = await fetch(SIMPLE_API, {cache:'no-store'});
        if(r.status===200){
          setOnline();
          await fetchDetails();
        } else if(r.status===404){
          setOffline();
        } else {
          setUnknown();
        }
      }catch(e){
        console.error('Status fetch error', e);
        setUnknown();
      }
    }
    function setOnline(){
      if(lastStatus!=='online'){ flashStatusChange(); lastStatus='online'; }
      statusBadge.className = 'status-badge online';
      statusBadge.textContent = 'ONLINE';
    }
    function setOffline(){
      if(lastStatus!=='offline'){ flashStatusChange(); lastStatus='offline'; }
      statusBadge.className = 'status-badge offline';
      statusBadge.textContent = 'OFFLINE';
      motdEl.textContent = 'Сервер офлайн';
      verEl.textContent = 'Версия: —';
      playersEl.textContent = '0 онлайн';
      playersListEl.style.display='none';
      pingEl.textContent = '—';
      document.title = 'YourStop — OFFLINE';
    }
    function setUnknown(){
      statusBadge.className = 'status-badge offline';
      statusBadge.textContent = 'НЕИЗВЕСТНО';
      motdEl.textContent = 'Не удалось определить статус';
    }

    async function fetchDetails(){
      try{
        const r = await fetch(JSON_API, {cache:'no-store'});
        if(!r.ok) return;
        const data = await r.json();
        if(!data.online){ setOffline(); return; }
        const motd = data.motd?.clean?.join(' ') || data.hostname || 'YourStop';
        motdEl.textContent = motd;
        verEl.textContent = 'Версия: ' + (data.version || '—');
        // players
        if(data.players?.list?.length){
          playersEl.textContent = (data.players?.online || data.players.list.length) + ' онлайн';
          playersListEl.innerHTML = data.players.list.slice(0, 20).map(p=>`<div class="player">🔹 ${escapeHtml(p)}</div>`).join('');
          playersListEl.style.display = 'flex';
        } else {
          playersEl.textContent = (data.players?.online || 0) + ' онлайн';
          playersListEl.style.display = 'none';
        }
        // ping
        pingEl.textContent = (data.debug?.ping ? data.debug.ping + ' ms' : (data.latency ? data.latency + ' ms' : '—'));
        document.title = `YourStop — ${data.players?.online || 0} онлайн`;
      }catch(e){
        console.error('Details fetch error', e);
      }
    }

    // helper
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[c]); }

    // small visual pulse for status change
    function flashStatusChange(){
      statusBadge.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:420});
    }

    // initial + interval
    fetchStatus();
    setInterval(fetchStatus, CHECK_INTERVAL*1000);

    // Tabs navigation
    document.querySelectorAll('.tab').forEach(t=>{
      t.addEventListener('click', ()=> {
        document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
        t.classList.add('active');
        const target = t.getAttribute('data-target');
        document.querySelectorAll('.pane').forEach(p=>{
          p.classList.remove('active');
        });
        const pane = document.getElementById(target);
        if(pane){ pane.classList.add('active'); window.scrollTo({top:0,behavior:'smooth'}); }
      });
    });

    // small toast
    let toastTimer = null;
    function showToast(text){
      let el = document.getElementById('___toast');
      if(!el){
        el = document.createElement('div');
        el.id='___toast';
        el.style.position='fixed';
        el.style.right='20px';
        el.style.bottom='20px';
        el.style.padding='10px 14px';
        el.style.borderRadius='10px';
        el.style.background='linear-gradient(90deg,var(--accent),var(--accent2))';
        el.style.color='#022033';
        el.style.fontWeight='800';
        el.style.boxShadow='0 10px 30px rgba(0,0,0,0.4)';
        document.body.appendChild(el);
      }
      el.textContent = text;
      el.style.opacity = '1';
      if(toastTimer) clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>{ el.style.opacity='0'; }, 2000);
    }

    /* ===================== Canvas particles & neon backdrop ===================== */
    (function(){
      const canvas = document.querySelector('canvas.bg');
      const ctx = canvas.getContext('2d');
      let w=innerWidth, h=innerHeight;
      canvas.width = w; canvas.height = h;
      const particles = [];
      const PARTICLE_COUNT = Math.min(120, Math.floor((w*h)/15000));
      let mx = w/2, my = h/2;

      function onResize(){ w=innerWidth; h=innerHeight; canvas.width=w; canvas.height=h; resetParticles(); }
      addEventListener('resize', onResize);
      addEventListener('mousemove', e=>{ mx=e.clientX; my=e.clientY; });

      function rand(min,max){ return Math.random()*(max-min)+min; }
      class P {
        constructor(){
          this.reset();
        }
        reset(){
          this.x = rand(0,w); this.y = rand(0,h);
          this.vx = rand(-0.25,0.25); this.vy = rand(-0.25,0.25);
          this.r = rand(0.6,2.2);
          this.h = rand(170,240);
          this.alpha = rand(0.12,0.9);
        }
        step(){
          this.x += this.vx; this.y += this.vy;
          if(this.x< -50 || this.x > w+50 || this.y < -50 || this.y > h+50) this.reset();
          // attraction to cursor
          const dx = this.x - mx, dy = this.y - my;
          const d = Math.sqrt(dx*dx+dy*dy);
          if(d < 120){
            this.x += (mx - this.x)*0.02;
            this.y += (my - this.y)*0.02;
          }
        }
        draw(){
          ctx.beginPath();
          const g = ctx.createRadialGradient(this.x,this.y,this.r*0.2,this.x,this.y,this.r*6);
          g.addColorStop(0, `hsla(${this.h},90%,70%,${this.alpha})`);
          g.addColorStop(0.4, `hsla(${this.h},85%,60%,${this.alpha*0.35})`);
          g.addColorStop(1, `rgba(3,6,10,0)`);
          ctx.fillStyle = g;
          ctx.arc(this.x,this.y,this.r*6,0,Math.PI*2);
          ctx.fill();
        }
      }

      function resetParticles(){
        particles.length = 0;
        for(let i=0;i<PARTICLE_COUNT;i++) particles.push(new P());
      }
      resetParticles();

      function loop(){
        ctx.clearRect(0,0,w,h);
        // subtle vignette
        ctx.fillStyle = 'rgba(3,6,10,0.18)';
        ctx.fillRect(0,0,w,h);
        for(const p of particles){ p.step(); p.draw(); }
        requestAnimationFrame(loop);
      }
      loop();
    })();

    /* Accessibility note: allow keyboard navigation between tabs */
    document.addEventListener('keydown', e=>{
      if(e.key === 'ArrowLeft' || e.key === 'ArrowRight'){
        const tabs = Array.from(document.querySelectorAll('.tab'));
        const idx = tabs.findIndex(t=>t.classList.contains('active'));
        if(idx >= 0){
          const next = e.key === 'ArrowRight' ? (idx+1)%tabs.length : (idx-1+tabs.length)%tabs.length;
          tabs[next].click(); tabs[next].focus();
        }
      }
    });

    // Metrics: if needed, we can show console info when pressing "I"
    document.addEventListener('keydown', e=>{
      if(e.key.toLowerCase()==='i' && e.ctrlKey){
        console.info('YourStop debug: SERVER=', SERVER);
        showToast('Debug выведен в консоль');
      }
    });

  </script>
</body>
</html>
